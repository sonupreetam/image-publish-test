groups:
  - id: registry.policy
    type: attribute_group
    display_name: Policy Engine Attributes
    brief: >
      Attributes emitted by policy engines (OPA, Gatekeeper, etc.) during policy evaluation and enforcement.
      Maps to GEMARA Layer 4 (Evaluation) for Policy-as-Code workflows.
    attributes:
      - id: policy.engine.name
        type: string
        stability: development
        brief: >
          Name of the policy engine that performed the evaluation or enforcement action.
        examples: [ "OPA", "Gatekeeper", "Conftest", "Sentinel" ]
        requirement_level: required
      - id: policy.engine.version
        type: string
        stability: development
        brief: >
          Version of the policy engine.
        examples: [ "v3.14.0", "v0.45.0", "v1.2.3", "v2.0.1" ]
        requirement_level: recommended
      - id: policy.rule.id
        type: string
        stability: development
        brief: >
          Unique identifier for the policy rule being evaluated or enforced.
        examples: [ "deny-root-user", "require-encryption", "check-labels" ]
        requirement_level: required
      - id: policy.rule.name
        type: string
        stability: development
        brief: >
          Human-readable name of the policy rule.
        examples: [ "Deny Root User", "Require Encryption", "Check Resource Labels" ]
        requirement_level: opt_in
      - id: policy.rule.uri
        type: string
        stability: development
        brief: >
          Source control URL and version of the policy-as-code file for auditability.
        examples:
          ["github.com/org/policy-repo/b8a7c2e", "gitlab.com/company/policies@v1.2.3"]
        requirement_level: recommended
      - id: policy.evaluation.result
        type:
          members:
            - id: "Not Run"
              value: "Not Run"
              brief: Policy evaluation was not run
              stability: development
            - id: "Passed"
              value: "Passed"
              brief: Policy evaluation passed
              stability: development
            - id: "Failed"
              value: "Failed"
              brief: Policy evaluation failed
              stability: development
            - id: "Needs Review"
              value: "Needs Review"
              brief: Policy evaluation needs manual review
              stability: development
            - id: "Not Applicable"
              value: "Not Applicable"
              brief: Policy evaluation is not applicable
              stability: development
            - id: "Unknown"
              value: "Unknown"
              brief: Policy evaluation result is unknown
              stability: development
        stability: development
        brief: >
          Outcome of the policy rule evaluation, indicating the result of the policy check.
        requirement_level: required
      - id: policy.evaluation.message
        type: string
        stability: development
        brief: >
          Additional context about the policy evaluation result.
        requirement_level: opt_in
        examples: ["The policy evaluation failed due to a missing attribute."]
      - id: policy.target.id
        type: string
        stability: development
        brief: >
          Unique identifier for the resource or entity being evaluated or enforced against.
        examples: [ "deployment-123", "resource-456", "user-789" ]
        requirement_level: recommended
      - id: policy.target.name
        type: string
        stability: development
        brief: >
          Human-readable name of the resource or entity being evaluated or enforced against.
        examples: [ "frontend-deployment", "s3-bucket-secrets", "admin-user" ]
        requirement_level: recommended
      - id: policy.target.type
        type: string
        stability: development
        brief: >
          Type of the resource or entity being evaluated or enforced against.
        examples: [ "deployment", "resource", "user", "configuration" ]
        requirement_level: recommended
      - id: policy.target.environment
        type: string
        stability: development
        brief: >
          Environment where the target resource or entity exists.
        examples: [ "production", "staging", "development" ]
        requirement_level: recommended

  - id: registry.compliance
    type: attribute_group
    display_name: Compliance Assessment Attributes
    brief: >
      Attributes added by compliance assessment tools to map policy results to compliance frameworks.
      Provides compliance context, risk assessment, and regulatory mapping for audit and reporting.
      Maps to GEMARA Layer 5 (Enforcement) for Policy-as-Code workflows.
    attributes:
      - id: compliance.control.id
        type: string
        stability: development
        brief: >
          Unique identifier for the security control and assessment requirement
          being assessed.
        examples:
          [ "OSPS-QA-07.01" ]
        requirement_level: required
      - id: compliance.control.category
        type: string
        stability: development
        brief: >
          Category or family that the security control belongs to.
        examples:
          [ "Access Control", "Quality"]
        requirement_level: recommended
      - id: compliance.control.catalog.id
        type: string
        stability: development
        brief: >
          Unique identifier for the security control catalog or framework.
        examples:
          [ "OSPS-B", "CCC", "CIS"]
        requirement_level: required
      - id: compliance.control.applicability
        type: string[]
        stability: development
        brief: >
          Environments or contexts where this control applies.
        examples: [ [ "Production", "Staging" ], [ "All Environments" ], [ "Kubernetes", "AWS" ] ]
        requirement_level: opt_in
      - id: compliance.frameworks
        type: string[]
        stability: development
        brief: >
          Regulatory or industry standards being evaluated for compliance.
        examples: [ [ "NIST-800-53", "ISO-27001" ] ]
        requirement_level: recommended
      - id: compliance.requirements
        type: string[]
        stability: development
        brief: >
          Compliance requirement identifiers from the frameworks impacted.
        examples: [ [ "AC-1", "A.9.1.1" ]]
        requirement_level: recommended
      - id: compliance.status
        type:
          members:
            - id: "Compliant"
              value: "Compliant"
              brief: Resource is compliant
              stability: development
            - id: "Non-Compliant"
              value: "Non-Compliant"
              brief: Resource is non-compliant
              stability: development
            - id: "Exempt"
              value: "Exempt"
              brief: Resource is exempt from compliance requirement
              stability: development
            - id: "Not Applicable"
              value: "Not Applicable"
              brief: Compliance requirement is not applicable
              stability: development
            - id: "Unknown"
              value: "Unknown"
              brief: Compliance status is unknown
              stability: development
        stability: development
        brief: >
          Overall compliance determination for the assessed resource or control, indicating whether it meets the compliance requirements.
        requirement_level: required
      - id: compliance.risk.level
        type:
          members:
            - id: "Critical"
              value: "Critical"
              brief: Critical risk level
              stability: development
            - id: "High"
              value: "High"
              brief: High risk level
              stability: development
            - id: "Medium"
              value: "Medium"
              brief: Medium risk level
              stability: development
            - id: "Low"
              value: "Low"
              brief: Low risk level
              stability: development
            - id: "Informational"
              value: "Informational"
              brief: Informational risk level
              stability: development
        stability: development
        brief: >
          Severity classification of the risk posed by non-compliance with the control requirement.
        requirement_level: opt_in
      - id: compliance.remediation.action
        type:
          members:
            - id: "Block"
              value: "Block"
              brief: Block the action
              stability: development
            - id: "Allow"
              value: "Allow"
              brief: Allow the action
              stability: development
            - id: "Remediate"
              value: "Remediate"
              brief: Remediate the issue
              stability: development
            - id: "Waive"
              value: "Waive"
              brief: Waive the requirement
              stability: development
            - id: "Notify"
              value: "Notify"
              brief: Notify about the issue
              stability: development
            - id: "Unknown"
              value: "Unknown"
              brief: Unknown remediation action
              stability: development
        stability: development
        brief: >
          Remediation action determined by the policy engine in response to the compliance assessment result.
        requirement_level: opt_in
      - id: compliance.remediation.status
        type:
          members:
            - id: "Success"
              value: "Success"
              brief: Remediation was successful
              stability: development
            - id: "Fail"
              value: "Fail"
              brief: Remediation failed
              stability: development
            - id: "Skipped"
              value: "Skipped"
              brief: Remediation was skipped
              stability: development
            - id: "Unknown"
              value: "Unknown"
              brief: Remediation status is unknown
              stability: development
        stability: development
        brief: >
          Outcome of the remediation action execution, indicating whether the remediation was successfully applied.
        requirement_level: opt_in
      - id: compliance.remediation.exception.id
        type: string
        stability: development
        brief: >
          Unique identifier for the approved exception, if applicable.
        examples: [ "EX-2025-10-001", "WAIVE-AC-1-001" ]
        requirement_level: opt_in
      - id: compliance.remediation.exception.active
        type: boolean
        stability: development
        brief: >
          Whether the exception is active for this enforcement.
        examples: [ true, false ]
        requirement_level: opt_in
      - id: compliance.remediation.description
        type: string
        stability: development
        brief: >
          Description of the recommended remediation strategy for this control.
        examples:
          [
            "This is a short description of the remediation strategy for this control.",
          ]
        requirement_level: opt_in
      - id: compliance.assessment.id
        type: string
        stability: development
        brief: >
          Unique identifier for the compliance assessment run or session.
          Used to group findings from the same assessment execution.
        examples: [ "assessment-2024-001", "scan-run-abc123", "compliance-check-xyz789" ]
        requirement_level: recommended
      - id: compliance.enrichment.status
        type:
          members:
            - id: "Success"
              value: "Success"
              brief: Enrichment was successful
              stability: development
            - id: "Unmapped"
              value: "Unmapped"
              brief: Enrichment could not be mapped
              stability: development
            - id: "Partial"
              value: "Partial"
              brief: Partial enrichment completed
              stability: development
            - id: "Unknown"
              value: "Unknown"
              brief: Enrichment status is unknown
              stability: development
            - id: "Skipped"
              value: "Skipped"
              brief: Enrichment was skipped
              stability: development
        stability: development
        brief: >
          Result of the compliance framework mapping and enrichment process, indicating whether compliance context was successfully added to the event.
        requirement_level: required
